{"version":3,"sources":["types/index.ts","components/infection-progress/data-chart.tsx","components/controls/population.tsx","components/controls/hospitals.tsx","components/controls/days.tsx","components/controls/update.tsx","components/controls/social-contacts.tsx","components/controls/travellers.tsx","components/infection-progress/infection-progress-controls.tsx","simulation/person.ts","simulation/utils.ts","simulation/virus.ts","simulation/simulation.ts","components/loader.tsx","components/infection-progress/all-infected-distribution.tsx","App.tsx","index.tsx"],"names":["InfectionStage","DataChart","data","totals","quarantineTime","itemWidth","Math","floor","length","days","map","day","death","total","severe","mild","incubation","healed","healthy","beds","hospitalBeds","i","Fragment","key","width","height","x","y","fill","general","byAge","style","color","dead","infected","toFixed","R0","onlyMildSymptoms","hadSevereSymptoms","severeNotHospitalized","getLegend","tableData","ageGroup","round","age","deathRateAll","deathRateClosed","mildOnly","dataSource","columns","title","dataIndex","statsByAge","PopulationControl","population","handlePopulationChange","sliders","Array","_","group","defaultValue","min","max","marks","0","10000","onAfterChange","amount","HospitalsControl","handleHospitalsChange","1000","DaysControl","handleDaysChange","Update","update","onClick","type","SocialContactsControl","contacts","handleContactsChange","handleChange","quarantineAge","100","avContactsGeneral","40","avContactsQuarantine","TravellersControl","travellers","handleTravellersChange","10","InfectionControls","simulationData","setSimulationData","padding","display","justifyContent","socialContacts","infectedPopulation","Person","id","immune","hospitalized","infectionDay","infectionSpread","currentStageDay","infectionsStage","nextStage","history","Map","nextDay","setStage","stage","set","heal","infect","this","uuid","Object","assign","probabilityFromAverage","average","value","exp","happenedToday","probability","random","getRandomSubArray","arr","subLength","Set","size","add","Covid19","characteristics","virusCharacteristics","transmissionChance","severeStateChance","person","averageMildToSevereDays","deathChance","averageSevereToDeathDays","recoverChance","averageMildToHealDays","averageSevereToHealDays","symptomsStartChance","averageIncubationDays","getNextStage","ageSevereChance","ageDeathChance","home","defaultQuarantine","Simulation","virus","travellersPerDay","incomingTravellers","progressInfection","progressSpread","push","run","occupiedBeds","filter","p","severeChance","live","forEach","loaderStyle","position","top","left","right","bottom","alignItems","backgroundColor","zIndex","Loader","active","defaultSimulation","AllInfectedDistribution","useState","calculating","setCalculating","lastRunSimulationData","useRef","setData","setTotals","useLayoutEffect","setTimeout","flatMap","simulation","window","nextData","getTotals","current","totalInfected","has","get","reduce","acc","App","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.8f2539b8.chunk.js","sourcesContent":["export interface IPerson {\n    id: string\n    age: number\n    immune: boolean\n    infected: boolean\n    hospitalized: boolean\n    severeNotHospitalized: boolean\n    infectionDay: number\n    infectionSpread: number\n    currentStageDay: number\n    infectionsStage: InfectionStage\n    history: Map<InfectionStage, number>\n    nextStage: InfectionStage\n\n    setStage: (stage: InfectionStage) => void\n    nextDay: () => void\n    heal: () => void\n    infect: () => void\n}\n\nexport enum InfectionStage {\n    healthy,\n    incubation,\n    mild,\n    severe,\n    death,\n    healed\n}\n\nexport interface IVirus {\n    transmissionChance: () => number\n    symptomsStartChance: (person: IPerson) => number\n    severeStateChance: (person: IPerson) => number\n    deathChance: (person: IPerson) => number\n    recoverChance: (person: IPerson) => number\n    getNextStage: (person: IPerson) => InfectionStage\n\n    characteristics: IVirusCharacteristics\n}\n\nexport interface IVirusCharacteristics {\n    transmissionChance: number,\n\n    averageIncubationDays: number,\n    averageMildToHealDays: number,\n    averageMildToSevereDays: number,\n    averageSevereToHealDays: number,\n    averageSevereToDeathDays: number,\n\n    ageSevereChance: number[],\n\n\n    ageDeathChance: {\n        hospitalized: number[],\n        home: number[]\n    }\n}\n\nexport interface ISimulation {\n    population: IPerson[]\n    virus: IVirus\n    day: number\n    hospitalBeds: number\n\n    nextDay: () => void\n    run: (days: number) => ISimulationHistory[]\n}\n\nexport interface ISimulationHistory {\n    total: number\n    incubation: number\n    mild: number\n    severe: number\n    death: number\n    healed: number\n    hospitalBeds: number\n}\n\nexport interface ISocialContacts {\n    quarantineAge: number\n    avContactsGeneral: number,\n    avContactsQuarantine: number\n    quarantineTime: number\n}\n","import React from 'react'\nimport {Divider, Table} from 'antd'\n\nexport interface DayData {\n    total: number\n    incubation: number\n    mild: number\n    severe: number\n    death: number\n    healed: number\n    hospitalBeds: number\n}\n\nexport interface ITotals {\n    total: number,\n    dead: number,\n    healed: number,\n    infected: number,\n    onlyMildSymptoms: number,\n    hadSevereSymptoms: number\n    severeNotHospitalized: number\n    R0: number\n}\n\nexport interface DataChartProps {\n    data: DayData[]\n    totals: {\n        byAge: ITotals[]\n        general: ITotals\n    }\n    quarantineTime: number\n}\n\nexport const DataChart: React.FC<DataChartProps> = ({ data, totals, quarantineTime }) => {\n    const width = 1000\n    const height = 500\n    const itemWidth = Math.floor(width / data.length)\n\n    const normalizedData = data.map(day => ({\n        death: day.death / day.total,\n        severe: day.severe / day.total,\n        mild: day.mild / day.total,\n        incubation: day.incubation / day.total,\n        healed: day.healed / day.total,\n        healthy: (day.total - day.death - day.severe - day.mild - day.incubation - day.healed) /day.total,\n        beds: day.hospitalBeds / day.total\n    }))\n\n    const days = normalizedData.map((day, i) => (\n      <React.Fragment key={i}>\n          <rect width={itemWidth} height={height * day.death} x={i * itemWidth}\n                y = {0} fill=\"black\"/>\n          <rect width={itemWidth} height={height * day.healthy} x={i * itemWidth}\n                y = {day.death * height} fill=\"grey\"/>\n          <rect width={itemWidth} height={height * day.healed} x={i * itemWidth}\n                y = {(day.death + day.healthy) * height} fill=\"green\"/>\n          <rect width={itemWidth} height={height * day.incubation} x={i * itemWidth}\n                y = {(day.death + day.healthy + day.healed) * height} fill=\"yellow\"/>\n          <rect width={itemWidth} height={height * day.mild} x={i * itemWidth}\n                y = {(day.death + day.healthy + day.healed + day.incubation) * height} fill=\"orange\"/>\n          <rect width={itemWidth} height={height * day.severe} x={i * itemWidth}\n                y = {(day.death + day.healthy + day.healed + day.incubation + day.mild) * height} fill=\"red\"/>\n          <rect width={itemWidth} height={2}  x={i * itemWidth} y={height - height * day.beds} fill=\"blue\"/>\n          <rect width={1} height={height} x={width * quarantineTime / data.length} y={0} fill=\"black\"/>\n      </React.Fragment>\n    ))\n\n    const {general, byAge} = totals\n\n    return (\n        <div>\n            <svg width={width} height={height}>\n                {days}\n            </svg>\n            {getLegend(general)}\n            {statsByAge(byAge)}\n        </div>\n    )\n}\n\nfunction statsByAge(data: ITotals[]) {\n    const tableData = data.map((totals, ageGroup) => ({\n        key: ageGroup,\n        total: totals.total,\n        infected: `${totals.infected} (${Math.round(100 * totals.infected / totals.total)}%)`,\n        dead: `${totals.dead} (${Math.round(100 * totals.dead / totals.total)}%)`,\n        age: `${ageGroup*10}-${ageGroup*10 + 9}`,\n        deathRateAll: `${(100 * totals.dead / totals.infected).toFixed(1)}%`,\n        deathRateClosed: `${(100 * totals.dead / (totals.dead + totals.healed)).toFixed(1)}%`,\n        mildOnly: `${(100 * totals.onlyMildSymptoms / totals.infected).toFixed(1)}%`\n    }))\n\n    const columns = [{\n        key: 'age',\n        title: 'Age Group',\n        dataIndex: 'age'\n    }, {\n        key: 'infected',\n        title: 'Infected',\n        dataIndex: 'infected'\n    }, {\n        key: 'dead',\n        title: 'Dead',\n        dataIndex: 'dead'\n    }, {\n        key: 'deathRateAll',\n        title: 'Mortality, all cases',\n        dataIndex: 'deathRateAll'\n    }, {\n        key: 'deathRateClosed',\n        title: 'Mortality, closed cases',\n        dataIndex: 'deathRateClosed'\n    }, {\n        key: 'mildOnly',\n        title: 'Mild cases',\n        dataIndex: 'mildOnly'\n    }]\n    return (\n        <Table dataSource={tableData} columns={columns}/>\n    )\n}\n\nfunction getLegend(data: ITotals) {\n    return (\n        <>\n            <h3 style={{ color: 'black' }}>\n                Dead: {data.dead},\n                {(100*data.dead/data.infected).toFixed(1)}% Dead/All Cases,\n                {(100*data.dead/(data.healed + data.dead)).toFixed(1)}% Dead/Closed Cases,\n                R0: {data.R0.toFixed(2)}\n            </h3>\n            <h3 style={{ color: 'green' }}>Healed: {data.healed}</h3>\n            <h3 style={{ color: 'grey'}}>\n                Not Infected: {data.total - data.infected}\n                ({(100*(1 - data.infected/data.total)).toFixed(1)}%)\n            </h3>\n            <h3 style={{ color: 'orange'}}>\n                Mild symptoms: {data.onlyMildSymptoms}\n                ({(100*data.onlyMildSymptoms/data.infected).toFixed(1)}%)\n            </h3>\n            <h3 style={{ color: 'red'}}>\n                Severe symptoms: {data.hadSevereSymptoms}\n                ({(100*data.hadSevereSymptoms/data.infected).toFixed(1)}%);\n                Not hospitalized: {data.severeNotHospitalized},\n                ({(100*data.severeNotHospitalized/data.hadSevereSymptoms).toFixed(1)}%);\n            </h3>\n            <h3 style={{ color: 'yellow'}}>Incubation</h3>\n            <Divider />\n            <h3>Total population: {data.total}</h3>\n            <h3>Total cases: {data.infected}</h3>\n        </>\n    )\n}\n","import React from 'react'\nimport {Slider} from 'antd'\n\ninterface PopulationProps {\n    handlePopulationChange: (group: number, amount: number) => void\n    population: number[]\n}\n\nexport const PopulationControl: React.FC<PopulationProps> = ({ population, handlePopulationChange }) => {\n    const sliders = Array(10).fill(0)\n        .map((_, group) => (\n            <div key={group}>\n                <h4>age group: {group*10}-{group*10 + 9}</h4>\n                <Slider\n                    defaultValue={population[group]}\n                    min={0}\n                    max={1e4}\n                    marks={{0: 0, 10000: 10000}}\n                    onAfterChange={(amount) => handlePopulationChange(group, amount as number)}\n                />\n            </div>\n        ))\n    return (\n        <div>\n            <h3>Population:</h3>\n            {sliders}\n        </div>\n    )\n}\n","import React from 'react'\nimport {Slider} from 'antd'\n\ninterface HospitalsControlProps {\n    handleHospitalsChange: (amount: number) => void\n    hospitalBeds: number\n}\n\nexport const HospitalsControl: React.FC<HospitalsControlProps> = ({ hospitalBeds, handleHospitalsChange }) => {\n    return (\n        <div>\n            <h3>Hospital beds:</h3>\n            <Slider\n                defaultValue={hospitalBeds}\n                min={0}\n                max={1e3}\n                marks={{0: 0, 1000: 1000}}\n                onAfterChange={(amount) => handleHospitalsChange(amount as number)}\n            />\n        </div>\n    )\n}\n","import React from 'react'\nimport {Slider} from 'antd'\n\ninterface DaysControlProps {\n    handleDaysChange: (amount: number) => void\n    days: number\n}\n\nexport const DaysControl: React.FC<DaysControlProps> = ({ days, handleDaysChange }) => {\n    return (\n        <div>\n            <h3>Simulation days:</h3>\n            <Slider\n                defaultValue={days}\n                min={0}\n                max={1e3}\n                marks={{0: 0, 1000: 1000}}\n                onAfterChange={(amount) => handleDaysChange(amount as number)}\n            />\n        </div>\n    )\n}\n","import React from 'react'\nimport {Button} from 'antd'\n\ninterface ButtonProps {\n    update: () => void\n}\n\nexport const Update: React.FC<ButtonProps> = ({ update }) => {\n    return <Button onClick={update} type=\"primary\">Run Simulation</Button>\n}\n","import React from 'react'\nimport {Slider} from 'antd'\nimport {ISocialContacts} from '../../types'\n\ninterface SocialContactsControlProps {\n    handleContactsChange: (amount: ISocialContacts) => void\n    contacts: ISocialContacts\n}\n\nexport const SocialContactsControl: React.FC<SocialContactsControlProps> = ({ contacts, handleContactsChange }) => {\n    const handleChange = (data: Partial<ISocialContacts>) => {\n        handleContactsChange({\n            ...contacts,\n            ...data\n        })\n    }\n    return (\n        <div>\n            <h2>Quarantine:</h2>\n            <h4>Quarantine Days:</h4>\n            <Slider\n                defaultValue={contacts.quarantineTime}\n                min={0}\n                max={1000}\n                marks={{0: 0, 1000: 1000}}\n                onAfterChange={(days) => handleChange({ quarantineTime: days as number })}\n            />\n            <h4>Quarantine age:</h4>\n            <Slider\n                defaultValue={contacts.quarantineAge}\n                min={0}\n                max={100}\n                marks={{0: 0, 100: 100}}\n                onAfterChange={(age) => handleChange({ quarantineAge: age as number })}\n            />\n            <h4>Average Contacts:</h4>\n            <Slider\n                defaultValue={contacts.avContactsGeneral}\n                min={0}\n                max={40}\n                marks={{0: 0, 40: 40}}\n                onAfterChange={(contacts) => handleChange({ avContactsGeneral: contacts as number })}\n            />\n            <h4>Contacts Quarantined:</h4>\n            <Slider\n                defaultValue={contacts.avContactsQuarantine}\n                min={0}\n                max={40}\n                marks={{0: 0, 40: 40}}\n                onAfterChange={(contacts) => handleChange({ avContactsQuarantine: contacts as number })}\n            />\n        </div>\n    )\n}\n","import React from 'react'\nimport {Slider} from 'antd'\n\ninterface TravellersControlProps {\n    handleTravellersChange: (amount: number) => void\n    travellers: number\n}\n\nexport const TravellersControl: React.FC<TravellersControlProps> = ({ travellers, handleTravellersChange }) => {\n    return (\n        <div>\n            <h3>Infected Travellers per day:</h3>\n            <p>* after quarantine ends</p>\n            <Slider\n                defaultValue={travellers}\n                min={0}\n                max={10}\n                marks={{0: 0, 10: 10}}\n                onAfterChange={(amount) => handleTravellersChange(amount as number)}\n            />\n        </div>\n    )\n}\n","import React from 'react'\nimport {PopulationControl} from '../controls/population'\nimport {HospitalsControl} from '../controls/hospitals'\nimport {Divider} from 'antd'\nimport {DaysControl} from '../controls/days'\nimport {Update} from '../controls/update'\nimport {SocialContactsControl} from '../controls/social-contacts'\nimport {ISocialContacts} from '../../types'\nimport {TravellersControl} from '../controls/travellers'\n\nexport interface ISimulationData {\n    infectedPopulation: number[]\n    hospitalBeds: number\n    days: number\n    travellers: number\n    socialContacts: ISocialContacts\n}\n\nexport interface InfectionControlsProps {\n    simulationData: ISimulationData\n    setSimulationData: (data: ISimulationData) => void\n    update: () => void\n}\n\nexport const InfectionControls: React.FC<InfectionControlsProps> = ({\n    simulationData, setSimulationData, update\n}) => {\n    const handlePopulationChange = (group: number, amount: number) => {\n        const infectedPopulation = [...simulationData.infectedPopulation]\n        infectedPopulation[group] = amount\n\n        setSimulationData({\n            ...simulationData,\n            infectedPopulation\n        })\n    }\n\n    const handleHospitalsChange = (hospitalBeds: number) => setSimulationData({\n        ...simulationData,\n        hospitalBeds\n    })\n\n    const handleDaysChange = (days: number) => setSimulationData({\n        ...simulationData,\n        days\n    })\n\n    const handleTravellersChange = (travellers: number) => setSimulationData({\n        ...simulationData,\n        travellers\n    })\n\n    const handleContactsChange = (socialContacts: ISocialContacts) => setSimulationData({\n        ...simulationData,\n        socialContacts\n    })\n\n    return (\n        <div style={{width: '100%', padding: '0 30px'}}>\n            <div style={{ display: 'flex', justifyContent: 'space-between' }}>\n                <h2>Controls</h2>\n                <Update update={update} />\n            </div>\n            <HospitalsControl hospitalBeds={simulationData.hospitalBeds} handleHospitalsChange={handleHospitalsChange}/>\n            <Divider />\n            <TravellersControl handleTravellersChange={handleTravellersChange} travellers={simulationData.travellers}/>\n            <Divider />\n            <DaysControl handleDaysChange={handleDaysChange} days={simulationData.days}/>\n            <Divider />\n            <SocialContactsControl handleContactsChange={handleContactsChange} contacts={simulationData.socialContacts}/>\n            <Divider />\n            <PopulationControl population={simulationData.infectedPopulation} handlePopulationChange={handlePopulationChange}/>\n        </div>\n    )\n}\n","import * as uuid from 'uuid'\nimport {InfectionStage, IPerson} from '../types'\n\nexport interface IPersonData {\n    age: number\n    immune?: boolean\n    infected?: boolean\n    hospitalized?: boolean\n    infectionDay?: number\n    currentStageDay?: number\n    infectionsStage?: InfectionStage\n    nextStage?: InfectionStage\n}\n\nexport class Person implements IPerson {\n    id: string\n    age: number\n    immune: boolean = false\n    infected: boolean = false\n    hospitalized: boolean = false\n    severeNotHospitalized: boolean = false\n    infectionDay: number = 0\n    infectionSpread: number = 0\n    currentStageDay: number = 0\n    infectionsStage: InfectionStage = InfectionStage.healthy\n    nextStage: InfectionStage = InfectionStage.incubation\n    history = new Map<InfectionStage, number>()\n\n    constructor(data: IPersonData) {\n        this.id = uuid.v4()\n        this.age = data.age\n        Object.assign(this, data)\n        if (this.infected && this.infectionsStage === InfectionStage.healthy) {\n            this.infectionsStage = InfectionStage.incubation\n        }\n\n        if (this.infectionsStage === InfectionStage.incubation) {\n            this.nextStage = InfectionStage.mild\n        }\n    }\n\n    nextDay = () => {\n        if (this.infected) {\n            this.infectionDay++\n            this.currentStageDay++\n        }\n    }\n\n    setStage = (stage: InfectionStage) => {\n        this.history.set(this.infectionsStage, this.currentStageDay)\n        this.currentStageDay = 0\n        this.infectionsStage = stage\n    }\n\n    heal = () => {\n        this.setStage(InfectionStage.healed)\n        this.immune = true\n        this.infected = false\n        this.hospitalized = false\n    }\n\n    infect = () => {\n        if (this.immune || this.infected) return;\n\n        this.infected = true\n        this.infectionsStage = InfectionStage.incubation\n        this.nextStage = InfectionStage.mild\n        this.infectionDay = 0\n        this.currentStageDay = 0\n    }\n}\n","//todo use sigmoid or similar distribution.\nexport function probabilityFromAverage(average: number, value: number): number {\n    const max = 1.05 * average\n    return value < max ? Math.exp(value - max)  : 1;\n}\n\nexport function happenedToday(probability: number): boolean {\n    return Math.random() < probability\n}\n\nexport function getRandomSubArray<T>(arr: T[], subLength: number): T[] {\n    const set = new Set<number>()\n    while (set.size < subLength) {\n        set.add(Math.floor(Math.random() * arr.length))\n    }\n\n    return [...set].map(i => arr[i])\n}\n","import {InfectionStage, IPerson, IVirus, IVirusCharacteristics} from '../types'\nimport {happenedToday, probabilityFromAverage} from './utils'\n\nexport class Covid19 implements IVirus {\n    characteristics: IVirusCharacteristics\n\n    constructor(characteristics: IVirusCharacteristics = virusCharacteristics) {\n        this.characteristics = characteristics\n    }\n    transmissionChance = () => this.characteristics.transmissionChance\n\n    severeStateChance = (person: IPerson) => {\n        if (!person.infected || person.infectionsStage !== InfectionStage.mild) return 0\n\n        return person.nextStage === InfectionStage.severe\n            ? probabilityFromAverage(this.characteristics.averageMildToSevereDays, person.currentStageDay)\n            : 0\n    }\n\n    deathChance = (person: IPerson) => {\n        if (!person.infected || person.infectionsStage !== InfectionStage.severe) return 0\n\n        return person.nextStage === InfectionStage.death\n            ? probabilityFromAverage(this.characteristics.averageSevereToDeathDays, person.currentStageDay)\n            : 0\n    }\n\n    recoverChance = (person: IPerson) => {\n        if (!person.infected) return 1\n        if (person.infectionsStage === InfectionStage.incubation) return 0\n\n        if (person.infectionsStage === InfectionStage.mild) {\n            return person.nextStage === InfectionStage.healed\n                ? probabilityFromAverage(this.characteristics.averageMildToHealDays, person.currentStageDay)\n                : 0\n        }\n\n        if (person.infectionsStage === InfectionStage.severe) {\n            return person.nextStage === InfectionStage.healed\n                ? probabilityFromAverage(this.characteristics.averageSevereToHealDays, person.currentStageDay)\n                : 0\n        }\n\n        return 1\n    }\n\n    symptomsStartChance = (person: IPerson) => {\n        if (!person.infected || person.infectionsStage !== InfectionStage.incubation) return 0\n\n        return probabilityFromAverage(this.characteristics.averageIncubationDays, person.infectionDay)\n    }\n\n    getNextStage = (person: IPerson) => {\n        if (person.infectionsStage === InfectionStage.incubation) return InfectionStage.mild\n        if (person.infectionsStage === InfectionStage.mild) {\n            return happenedToday(this.characteristics.ageSevereChance[Math.floor(person.age / 10)])\n                ? InfectionStage.severe\n                : InfectionStage.healed\n        }\n        if (person.infectionsStage === InfectionStage.severe) {\n            const deathRates = person.hospitalized\n                ? this.characteristics.ageDeathChance.hospitalized\n                : this.characteristics.ageDeathChance.home\n\n            return happenedToday(deathRates[Math.floor(person.age / 10)])\n                ? InfectionStage.death\n                : InfectionStage.healed\n\n        }\n\n        //todo: Really? Maybe fix me\n        return InfectionStage.death\n    }\n}\n\nconst virusCharacteristics: IVirusCharacteristics = {\n    transmissionChance: .005,\n\n    averageIncubationDays: 10,\n    averageMildToHealDays: 14,\n    averageMildToSevereDays: 7,\n    averageSevereToHealDays: 21,\n    averageSevereToDeathDays: 5,\n\n    ageSevereChance: [.01, .03, .03, .03, .06, .14, .32, .5, .65, .7],\n\n    ageDeathChance: {\n        hospitalized: [.1, .15, .15, .15, .20, .25, .33, .45, .65, .7],\n        home: [.1, .25, .25, .25, .35, .4, .5, .75, .9, .95],\n//        home: [.3, .3, .3, .6, .6, .8, .9, .95, .95, 1]\n    }\n}\n","import {InfectionStage, IPerson, ISimulation, ISimulationHistory, ISocialContacts, IVirus} from '../types'\nimport {Covid19} from './virus'\nimport {getRandomSubArray, happenedToday} from './utils'\nimport {Person} from './person'\n\nconst defaultQuarantine: ISocialContacts = {\n    avContactsGeneral: 20,\n    avContactsQuarantine: 1,\n    quarantineTime: 60,\n    quarantineAge: 0\n}\n\nexport class Simulation implements ISimulation{\n    hospitalBeds = 0\n    population: IPerson[]\n    virus: IVirus\n    day = 0\n    socialContacts: ISocialContacts = defaultQuarantine\n    private travellersPerDay: number\n\n    constructor(population: IPerson[] = [],\n                virus = new Covid19(),\n                hospitalBeds = 0,\n                socialContacts: ISocialContacts = defaultQuarantine,\n                travellers = 0,\n    ) {\n        this.population = population\n        this.virus = virus\n        this.hospitalBeds = hospitalBeds\n        this.socialContacts = socialContacts\n        this.travellersPerDay = travellers\n    }\n\n    nextDay = () => {\n        this.day++\n\n        this.incomingTravellers()\n        this.progressInfection()\n        this.progressSpread()\n    }\n\n    incomingTravellers = () => {\n        if (this.day < this.socialContacts.quarantineTime) return;\n\n        const travellers = Array(this.travellersPerDay)\n            .fill(35)\n            .map(age => new Person({ age, infected: true }))\n        this.population.push(...travellers)\n    }\n\n\n    run = (days: number): ISimulationHistory[] => {\n        const history = []\n        for (let day = 0; day < days; day++) {\n            this.nextDay();\n\n            let incubation = 0;\n            let mild = 0;\n            let severe = 0;\n            let death = 0;\n            let healed = 0;\n\n            for (let i = 0; i < this.population.length; i++) {\n                switch (this.population[i].infectionsStage) {\n                    case InfectionStage.incubation:\n                        incubation++;\n                        break;\n                    case InfectionStage.mild:\n                        mild++;\n                        break;\n                    case InfectionStage.severe:\n                        severe++;\n                        break;\n                    case InfectionStage.death:\n                        death++;\n                        break;\n                    case InfectionStage.healed:\n                        healed++;\n                        break;\n                }\n            }\n            history.push({\n                total: this.population.length,\n                incubation,\n                mild,\n                severe,\n                death,\n                healed,\n                hospitalBeds: this.hospitalBeds\n            })\n        }\n\n        return history\n    }\n\n    private progressInfection() {\n\n        let occupiedBeds = this.population.filter(p => p.hospitalized).length;\n\n        for (let i = 0; i < this.population.length; i++) {\n            let person = this.population[i];\n            if (!person.infected) continue;\n            person.nextDay()\n\n            switch (person.infectionsStage) {\n                case InfectionStage.incubation: {\n                    const symptomsChance = this.virus.symptomsStartChance(person)\n                    if (happenedToday(symptomsChance)) {\n                        person.setStage(InfectionStage.mild)\n                        person.nextStage = this.virus.getNextStage(person)\n                    }\n                    break;\n                }\n\n                case InfectionStage.mild: {\n                    const severeChance = this.virus.severeStateChance(person)\n                    const recoverChance = this.virus.recoverChance(person)\n\n                    if (happenedToday(severeChance)) {\n                        person.setStage(InfectionStage.severe)\n                        if (occupiedBeds <= this.hospitalBeds) {\n                          person.hospitalized = true\n                          occupiedBeds++;\n                        } else {\n                            person.severeNotHospitalized = true\n                        }\n                        person.nextStage = this.virus.getNextStage(person)\n                    } else if (happenedToday(recoverChance)) {\n                        person.heal()\n                    }\n                    break;\n                }\n\n                case InfectionStage.severe: {\n                    const deathChance = this.virus.deathChance(person)\n                    const recoverChance = this.virus.recoverChance(person)\n\n                    if (happenedToday(deathChance)) {\n                        person.setStage(InfectionStage.death)\n                        person.hospitalized = false\n                    } else if (happenedToday(recoverChance)) {\n                        person.heal()\n                    }\n\n                    break;\n                }\n\n                default: break;\n            }\n        }\n    }\n\n    private progressSpread() {\n        const {quarantineAge, avContactsGeneral, avContactsQuarantine, quarantineTime} = this.socialContacts\n        const live = this.population.filter(p => p.infectionsStage !== InfectionStage.death)\n\n        for (let i = 0; i < this.population.length; i++) {\n            let person = this.population[i];\n            const contacts = this.day < quarantineTime && person.age >= quarantineAge\n                ? avContactsQuarantine\n                : avContactsGeneral\n\n            getRandomSubArray(live, contacts)\n                .forEach(p => {\n                    if (!p.infected || !happenedToday(this.virus.transmissionChance())) return;\n\n                    p.infectionSpread++\n                    person.infect()\n                })\n        }\n    }\n}\n\n","import React from 'react'\n\nexport interface ILoaderProps {\n    active: boolean\n}\n\nconst loaderStyle: any = {\n    position: 'fixed',\n    top: 0, left: 0,\n    right: 0, bottom: 0,\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    backgroundColor: 'rgba(0,0,0,0.5)',\n    zIndex: 999\n}\n\nexport const Loader: React.FC<ILoaderProps> = ({ active }) => {\n    if (!active) return null;\n\n    return <div style={loaderStyle}>\n        <h2 style={{color: '#fff'}}>Running Simulation, it can take a while...</h2>\n    </div>\n}\n","import React, {useState, useRef, useLayoutEffect} from 'react'\nimport {InfectionStage, IPerson, ISimulationHistory} from '../../types'\nimport {DataChart, ITotals} from './data-chart'\nimport {InfectionControls, ISimulationData} from './infection-progress-controls'\nimport {Person} from '../../simulation/person'\nimport {Simulation} from '../../simulation/simulation'\nimport {Covid19} from '../../simulation/virus'\nimport {getRandomSubArray} from '../../simulation/utils'\nimport {Loader} from '../loader'\n\nexport interface AllInfectedDistributionProps {\n}\n\nconst defaultSimulation: ISimulationData = {\n    //Ukraine age population: https://ukrstat.org/uk/druk/publicat/kat_u/2019/zb/07/zb_rpnu2019.pdf page 26\n    //'1960529, 2 372 969, 2 147 481, 1 834 598, 2 200 523, 2 886 099, 3 563 993, 3 358 614, 3 069 863, 2 907 414, 2 743 877 , 3 110 494, 2 792 559, 2 389 627, 1 474 886, 1 382 695, 1 787 343'\n    //the last to numbers age given as 80+, my split is 1000000 and 787343\n    // [4333498, 3982079, 5086622, 6922607, 5977277, 5854371, 5182186, 2857581, 1000000, 787343]\n    infectedPopulation: [4333, 3982, 5086, 6922, 5977, 5854, 5182, 2857, 1000, 787],\n    //infectedPopulation: [1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000],\n    hospitalBeds: 150,\n    travellers: 2,\n    days: 400,\n    socialContacts: {\n        avContactsQuarantine: 1,\n        avContactsGeneral: 20,\n        quarantineAge: 50,\n        quarantineTime: 90\n    }\n}\n\nexport const AllInfectedDistribution: React.FC<AllInfectedDistributionProps> = () => {\n    const [calculating, setCalculating] = useState<boolean>(true)\n    const [simulationData, setSimulationData] = useState<ISimulationData>(defaultSimulation)\n    const lastRunSimulationData = useRef<ISimulationData>(simulationData)\n\n    const [data, setData] = useState<ISimulationHistory[] | null>(null)\n    const [totals, setTotals] = useState<any>(null)\n\n    const update = () => setCalculating(true)\n\n    const recalculate = () => {\n        if (!calculating) return;\n\n        //todo: I'll move this dirty hack to WebWorker\n        setTimeout(() => {\n            const population = simulationData.infectedPopulation\n                .flatMap((amount, group) =>\n                    Array(amount).fill(group * 10 + 5).map(age => new Person({ age }))\n                )\n\n            getRandomSubArray(population, 1000).forEach(person => person.infect())\n\n            const simulation = new Simulation(population, new Covid19(), simulationData.hospitalBeds, simulationData.socialContacts);\n            (window as any).simulation = simulation\n\n            const nextData = simulation.run(simulationData.days)\n            const totals = {\n                general: getTotals(simulation.population),\n                byAge: Array(10).fill(0).map((_, age) =>\n                    getTotals(simulation.population.filter(p => p.age >= age * 10 && p.age < (age + 1) * 10))\n                )\n            }\n            setCalculating(false)\n            setData(nextData)\n            setTotals(totals)\n            lastRunSimulationData.current = simulationData\n        })\n\n    }\n\n    useLayoutEffect(recalculate, [calculating])\n\n    return (\n        <div>\n            <Loader active={calculating}/>\n            <h1>Naive Infection Distribution</h1>\n            <div style={{ display: 'flex' }}>\n            {data && totals && <DataChart data={data} totals={totals} quarantineTime={simulationData.socialContacts.quarantineTime}/>}\n            <InfectionControls update={update} simulationData={simulationData} setSimulationData={setSimulationData} />\n            </div>\n        </div>\n    )\n}\n\n\nfunction getTotals(population: IPerson[]): ITotals {\n    const totalInfected = population.filter(p => p.infectionsStage !== InfectionStage.healthy)\n\n    return {\n        total: population.length,\n        dead: population.filter(p => p.infectionsStage === InfectionStage.death).length,\n        infected: totalInfected.length,\n        healed: population.filter(p => p.infectionsStage === InfectionStage.healed).length,\n        onlyMildSymptoms: totalInfected.filter(p =>\n            p.history.has(InfectionStage.incubation) && !p.history.get(InfectionStage.severe)\n        ).length,\n        hadSevereSymptoms: totalInfected.filter(p =>\n            p.history.has(InfectionStage.severe) || p.infectionsStage === InfectionStage.severe\n        ).length,\n        severeNotHospitalized: totalInfected.filter(p => p.severeNotHospitalized).length,\n        R0: totalInfected.reduce((acc, p) => acc + p.infectionSpread, 0)/totalInfected.length\n    }\n}\n","import React from 'react';\nimport {AllInfectedDistribution} from './components/infection-progress/all-infected-distribution'\n\nfunction App() {\n  return (\n    <div>\n      <AllInfectedDistribution />\n    </div>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport 'antd/dist/antd.css'\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}